<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <title>Şervan ALKAN | Blog</title>
    <!-- Mobil uyum kodu-->
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <!------->

    <meta content="Şervan ALKAN" name="Şervan ALKAN, cyber security">
    <meta content="Şervan ALKAN"
          name="I'm Şervan Alkan. I am a 3rd year student of Mersin University Computer Technology and Information Systems.">

    <!-- Favicon -->
    <link href="img/profile.jpg" rel="icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:300;400;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Bootstrap kodları -->
    <link href="css/style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
</head>

<body style="background-color: #f1f3ff;">
<div class="wrapper">
    <div class="sidebar">
        <div class="sidebar-text d-flex flex-column h-100 justify-content-center text-center">
            <img style="background-color: grey !important;"
                 class="mx-auto d-block w-75 bg-primary img-fluid rounded-circle mb-4 p-3"
                 src="img/profile.jpg"
                 alt="pp">
            <h1 class="font-weight-bold">Şervan ALKAN</h1>
            <p class="mb-4">
                I'm Şervan Alkan. I am a 3rd year student of Mersin University Computer Technology and Information
                Systems. My lessons are usually online, I don't have much contact with the university except during exam
                weeks. In this way, in addition to my lessons, I have the chance to do research and improve myself too.

            </p>
            <div class="d-flex justify-content-center mb-5">
                <a target="_blank" class="btn btn-outline-primary mr-2"
                   href="https://www.linkedin.com/in/servanalkan/"><i style="color: grey !important;"
                                                                      class="fab fa-linkedin-in"></i></a>
                <a target="_blank" class="btn btn-outline-primary mr-2" href="https://www.instagram.com/servan.tech/"><i
                        style="color: grey !important;"
                        class="fab fa-instagram"></i></a>
            </div>
        </div>
        <div class="sidebar-icon d-flex flex-column h-100 justify-content-center text-right">
            <i class="fas fa-2x fa-angle-double-right text-primary"></i>
        </div>
    </div>
    <div class="content">
        <!-- Navbar Start -->
        <div class="container p-0">
            <nav style="background-color: grey !important;" class="navbar navbar-expand-lg bg-secondary navbar-dark">
                <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                    <div class="navbar-nav m-auto">
                        <a style="color: white;" href="index.html" class="nav-item nav-link">Blog</a>
                    </div>
                </div>
            </nav>
        </div>
        <!-- Navbar End -->

        <!-- Page Header Start -->
        <!--        <div style="background-color: dimgrey !important;" class="container py-5 px-2 bg-primary">-->
        <style>
            #bgimg {
                background-image: url('img/image001.jpg');
                width: 100%;
                background-size: 100%;
            }
        </style>
        <div id="bgimg" class="container py-5 px-2 bg-primary">
            <div class="row py-5 px-4">
                <div class="col-sm-6  ">
                    <h1 class="mb-3 mb-md-0 text-white font-weight-bold">Trust no one. Microsoft Windows
                        exploited!</h1>
                </div>
            </div>
        </div>
        <!-- Page Header End -->


        <!-- About Start -->
        <div class="container bg-white pt-5">
            <div class="row px-3 pb-5">
                <div class="col-md-12">
                    <h2>Microsoft has confirmed the "Remote Code Execution" vulnerability that has been exploited in the
                        "Microsoft Windows Support Diagnostic Tool (MSDT)" service since at least April…
                    </h2>
                    <h2> Are we really safe?</h2>

                    <p class="m-0">
                        In this article, I will address the MSDT vulnerability of Windows.
                    </p>
                    <p>
                        The vulnerability, identified by MITRE as <a
                            href="https://www.cvedetails.com/cve-details.php?t=1&cve_id=CVE-2022-30190">CVE-2022-30190</a>
                        <b>(Follina Zero-Day, CVSS:9.3)</b>, allows
                        misuse of the Windows Support Diagnostic Tool through Microsoft Office documentation on Windows
                        platforms. Worse still, it is actively used by cybercriminals because there is still no solution
                        for this vulnerability, but it is estimated that the necessary patches are prepared for the new
                        update.
                    </p>
                    <img style=" width:70%;display: block; margin: auto;" src="img/image003.jpg">
                    <em style="display: block; margin: auto;text-align:center;opacity: 0.7;">Figure 2. Microsoft Support
                        Diagnostic Tool (MSDT)</em>
                    <br>
                    <p>
                        Cyberspace is getting more and more terrifying in a world that evolves and becomes more digital
                        as it evolves. Financial assets, reputations, personal data and more lost due to a bug in a
                        small code snippet…
                    </p>
                    <p>
                        Recognized as a battleground by NATO at the 2016 Warsaw summit, cyberspace is as dangerous and
                        terrifying as any other battlefield, and even the systems we trust can be attacked.
                    </p>
                    <p>
                        Microsoft company, one of the giants of the digital world, has confirmed the security
                        vulnerability on Windows platforms, which has been exploited since at least April. Well what
                        does it mean?
                    </p>
                    <p>
                        After Microsoft's statement, it becomes clear that all systems using Windows OS (Table 1.) have
                        been in grave danger since at least April, and systems that do not use the "workarounds"
                        suggested by Microsoft are potential targets of attackers who take advantage of this
                        vulnerability.

                    </p>

                    <h4>Here are the Windows products affected by this vulnerability:</h4>
                    <br>
                    <em style="display: block; margin: auto;text-align:left;opacity: 0.7;">
                        Table 1. Windows versions affected by Follina (CVE-2022-30190) vulnerability
                    </em>
                    <img style=" width:50%;display: block; margin: auto;" src="img/image005.jpg">
                    <br>
                    <p>
                        If you are wondering what Remote Code Execution is, here is the definition of this
                        vulnerability:
                    </p>
                    <p>
                        <b>Remote Code Execution:</b> A vulnerability that allows an attacker to access the target's
                        system via
                        malicious software and execute various commands on the system.

                    </p>
                    <h4>Summary of the vulnerability:</h4>
                    <p>
                        It's worth noting that the attack happened locally and requires user input for execution, so as
                        Fortinet analysis points out, the "remote" aspect refers to the attacker's location. Follina
                        allows RCE in environments by exploiting a vulnerability specific to Windows operating systems
                        in the Microsoft Support Diagnostic Tool (MSDT) provided by malicious Microsoft Office documents
                        that loads HTML files from a remote location and executes malicious PowerShell commands.
                    </p>
                    <p>
                        The observed malicious document can abuse Microsoft Word's remote template feature and pull the
                        HTML file containing embedded JavaScript code that uses the ms-msdt scheme to execute a
                        PowerShell “Invoke-Expression” command. The command kills the Microsoft Support Diagnostic Tool
                        (msdt.exe) process and runs the malicious rgb.exe executable after running the files that are
                        eventually contained in a .RAR file.
                    </p>
                    <p>
                        The researchers noted that the file is still executable in Microsoft Word with macros disabled
                        and could potentially be abused by using a .RTF file instead of the observed .DOC file to bypass
                        protected view or "preview".

                    </p>
                    <h4>How do attackers exploit this vulnerability?</h4>
                    <p>The Microsoft Support Diagnostic Tool <b>(Figure 2.)</b> that caused the vulnerability is
                        actually used
                        to send diagnostic information to Microsoft when something goes wrong with Windows. This tool is
                        called via MSDT URL protocol from other applications.
                    </p>
                    <p>
                        In the statement made by the researchers who discovered the vulnerability, it was stated that
                        the attackers, using social engineering and phishing methods, sent an e-mail containing a
                        malicious file to the user and convinced the user to open this e-mail with an interesting title.
                    </p>
                    <img style=" width:50%;display: block; margin: auto;" src="img/image006.jpg">
                    <em style="display: block; margin: auto;text-align:center;opacity: 0.7;">
                        Figure 3. Malicious File
                    </em>
                    <br>
                    <p>If the vulnerability is successfully exploited, the attacker gains control of the system with the
                        user rights of the application calling MSDT. If the user has administrator rights, this
                        vulnerability gives full authority over the entire system, allowing the attacker to create very
                        large threats.</p>
                    <p>
                        <b>
                            Other information Microsoft has published about this vulnerability via <a
                                href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190">MSRC</a>
                            is as follows:
                        </b>
                    </p>
                    <br>
                    <img style=" width:50%;display: block; margin: auto;" src="img/image008.png">
                    <em style="display: block; margin: auto;text-align:center;opacity: 0.7;">
                        Figure 4. MSRC vulnerability metric
                    </em>
                    <br>
                    <h5>Executive Summary (MSRC):</h5>
                    <p>
                        <i>
                            “A remote code execution vulnerability exists when MSDT is called using the URL protocol
                            from
                            a
                            calling application such as Word. An attacker who successfully exploits this vulnerability
                            can
                            run arbitrary code with the privileges of the calling application. The attacker can then
                            install
                            programs, view, change, or delete data, or create new accounts in the context allowed by the
                            user’s rights.”
                        </i>
                    </p>
                    <br>
                    <h5>
                        Exploitability (MSRC):
                    </h5>
                    <br>
                    <img style=" width:50%;display: block; margin: auto;" src="img/image010.jpg">
                    <em style="display: block; margin: auto;text-align:center;opacity: 0.7;">
                        Figure 5. Exploitability of vulnerability (MSRC)
                    </em>
                    <br>
                    <h4>So which attack groups/campaigns feed off this vulnerability?</h4>
                    <p>There isn't a big wave of attacks on this vulnerability, but there are attacks against EU/US and
                        other targets. On the other hand, <a href="https://www.proofpoint.com/us">Proofpoint</a> company
                        reported that they intervened in a phishing
                        campaign attacking customers in EU and US government institutions. State actors are suspected to
                        be behind the action.</p>
                    <p>
                        An attack was also observed in the South Pacific originating from servers in Palau. In the
                        process, this vulnerability was exploited to sign a company-owned digital certificate. CERT-UA
                        also warns of attacks on government targets in Ukraine.
                    </p>
                    <p>
                        Additionally, this vulnerability has been confirmed to have been exploited by threat groups such
                        as <a href="https://malpedia.caad.fkie.fraunhofer.de/actor/ta413">TA413</a> linked to the
                        Chinese
                        government, as well as the first attacks targeting the
                        Philippines, Nepal and India earlier in the year (2022).
                    </p>
                    <h4>How can we be protected?</h4>
                    <p>
                        It is known that Microsoft has not released a security patch for this vulnerability, but
                        preparations have been made in this direction. That's why Microsoft published the recommended
                        solutions to reduce the threat. These workarounds include turning off the MSDT URL protocol,
                        preventing office documents from communicating with MSDT.
                    </p>
                    <h6>Here are those suggestions:</h6>
                    <h6>Workarounds</h6><br>
                    <h6>To disable the MSDT URL Protocol</h6>
                    <p>
                        Disabling MSDT URL protocol prevents troubleshooters being launched as links including links
                        throughout the operating system. Troubleshooters can still be accessed using the Get Help
                        application and in system settings as other or additional troubleshooters. Follow these steps to
                        disable:
                    </p>

                    <ol>
                        <li>
                            Run Command Prompt as Administrator.
                        </li>
                        <li>
                            To back up the registry key, execute the command “reg export HKEY_CLASSES_ROOT\ms-msdt
                            filename“
                        </li>
                        <li>
                            Execute the command “reg delete HKEY_CLASSES_ROOT\ms-msdt /f”.
                        </li>
                    </ol>
                    <h6>How to undo the workaround</h6>
                    <ol>
                        <li>
                            Run Command Prompt as Administrator.
                        </li>
                        <li>
                            To restore the registry key, execute the command “reg import filename”
                        </li>
                    </ol>

                    <p><b>Finally</b>, since there is still no security patch for this vulnerability, systems using the
                        windows
                        versions listed in Table 1. should protect themselves by following Microsoft's recommended
                        threat mitigation guidelines until the security patch is released.</p>
                    <h5><b>Resources:</b></h5>
                    <ul>
                        <li>
                            <a href="https://www.cvedetails.com/cve-details.php?t=1&cve_id=CVE-2022-30190">CVE
                                Details</a>
                        </li>
                        <li>
                            <a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190">Microsoft</a>
                        </li>
                        <li>
                            <a href="https://www.proofpoint.com/us">ProofPoint</a>
                        </li>
                        <li>
                            <a href="https://malpedia.caad.fkie.fraunhofer.de/actor/ta413">MalPedia</a>
                        </li>
                    </ul>

                </div>
            </div>
            <!-- About End -->


            <!-- Footer Start -->
            <div class="container py-4 bg-secondary text-center">
                <p class="m-0 text-white">
                    <a>© Made with ♥ by Şervan ALKAN | 2022</a>
                </p>
            </div>
            <!-- Footer End -->
        </div>
    </div>

    <!-- Back to Top -->
    <a href="#" class="back-to-top"><i class="fa fa-angle-double-up"></i></a>

    <!-- JavaScript Libraries -->

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>